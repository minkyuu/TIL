# 2021.8.1 TIL (Automation using python)

### Python - 파일 입출력

```
open('파일이름', '파일에 수행 명령어')

- 수행 명령어
 1. 'w' : 글쓰기 (이전에 작성된 내용은 무시하고 새로 쓴다)
 2. 'r' : 내용 읽기
 3. 'a' : 기존의 내용을 건드리지 않고 뒤에다가 글을 쓴다.
```


### Python - 파일 다루기

```
- csv 파일
 : comma-separated values의 약자
 : ','와 개행 문자로 구분된 파일
 : 엑셀과 유사한 형태로 읽고 쓸 수 있다.
 : ','로 컬럼을 구분하고 개행 문자로 행을 구분한다
```

### Python - openpyxl 패키지 사용
```
wb = load_workbook('simple_data.xlsx')
 : 엑셀 파일의 내용을 모두 읽어들여서 Workbook클래스로 반환하는 함수 load_workbook( )
 : wb에 결과가 담긴 Workbook 클래스를 넣는다.


data = wb.active
 : wb에 담긴 엑셀을 활성화시키는 변수



행 따로 열 따로 데이터를 가져올 수 있다.
ex) row = data['2'] // col = data['A']



엑셀 파일을 보면 아래쪽에 시트의 이름이 있는데 파이썬에서 이를 이용해서 원하는 시트의 데이터를 불러올 수 있다.

data = wb['simple_test']
-> simple_test라는 시트이름의 데이터를 가져와서 data에 저장
```


### Python - 엑셀 파일에 내용 쓰기
```
- 사람 vs 프로그램

1. 사람
 - 데이터를 입력할 엑셀 파일을 생성하거나 연다.
 - 데이터를 쓸 시트를 생성하거나 연다.
 - 원하는 위치에 데이터를 쓴 후 저장

2. 프로그램
 - 데이터를 쓸 엑셀 파일의 파일명으로 클래스 변수를 생성한다. (or 파일명 없이 클래스 변수 생성)
 - 클래스 변수에서 시트이름으로 원하는 시트를 가져오거나 생성
 - 원하는 위치에 데이터를 입력한 후 저장
```


### Python - 큰 엑셀 파일 내용 읽기
```
- load_workbook의 문제점
: load_workbook은 모든 엑셀의 내용을 파이썬으로 한 번에 가져온다.
1. 엑셀 파일이 매우 큰 경우 못 가져오는 문제가 발생
2. 한 번에 가져오는 과정이 매우 느림

-> 그래서 모든 내용을 한 번에 가져오지 않는 방법을 사용한다!


load_workbook('test_data.xlsx', read_only=True)
-> read_only속성을 추가하면 load_workbook함수 호출 시 많은 양의 데이터를 다 가져오지 않는다.
-> cell의 타입이 cell에서 ReadOnlyCell로 변경된다.


데이터를 읽을 때 iter_rows( ) 함수를 쓰는것을 권장한다.
iter_cols( ) 같은 경우 데이터를 조회할 때 행 전체를 거쳐서 왼쪽에서 오른쪽으로 넘어가기 때문에 데이터가 많을수록 부하가 심함
```


###Python - 이메일 발송 원리
```
메일 프로그램에서 친숙한 설정 정보
- SMTP 서버 주소
- POP 서버 주소
- SMTP 서버 포트
- POP 서버 포트
- 계정 정보


메일을 보낼 때 필요한 설정 정보
- SMTP 서버 주소
: 메일 보내는 서버 주소

- POP 서버 주소
: 메일 받는 서버 주소

- SMTP 서버 포트
: SMTP 주소로 갈 때 사용할 경로 번호

- POP 서버 포트
: POP 주소로 갈 때 사용한 경로 번호

- 계정 정보
: 아이디, 비밀번호


이메일 발송 단계 (실습은 SMTP로)
1. 서버가 원하는 형태의 모습으로 데이터 가공
-> 보내는 사람, 받는 사람, 제목, 내용 등
2. SMTP 서버에 로그인
3. SMTP 서버로 데이터 전송
```
